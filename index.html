<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUXECS2 Command</title>
    <link rel="icon" href="favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div class="loading-screen" id="loading-screen">
        <div class="loading-container">
            <div class="letter">LUX</div>
            <div class="letter">CS2</div>
        </div>
    </div>
    
    <div id="main-content">
        <video id="background-video" autoplay muted loop>
            <source src="https://dl.dropboxusercontent.com/s/q2atq0k4ghou72wy4tzwr/mixkit-stars-in-space-background-1610-4k.mp4?rlkey=fjd5rem01pwbctx01ktfnpe02&st=7pzi2nob&dl=0" type="video/mp4">
        </video>
        <div class="overlay"></div>
        <div class="particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
        
        <button id="back-button" onclick="goBack()">–ù–∞–∑–∞–¥</button>
        
        <div class="main-interface" id="main-interface">
            <img src="img/luxesc.png" alt="LUXECS2 Logo" class="logo">

            <div class="monitoring-section">
                <h2 class="monitoring-title">üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–æ–≤</h2>
                <div class="servers-container" id="servers-container">
                    <div class="server-card loading">
                        <div class="server-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                    </div>
                </div>
            </div>

            <div class="buttons-container">
                <button class="button" onclick="showAbout()">
                    <span class="button-icon">‚ÑπÔ∏è</span> –û –Ω–∞—Å
                </button>
                <div class="dropdown-container">
                    <button class="button" onclick="toggleDropdown()">
                        <span class="button-icon">üöÄ</span> –ü—Ä–æ–µ–∫—Ç—ã <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <ul class="dropdown-content" id="project-dropdown">
                        <li onclick="window.open('https://luxecs2.ru', '_blank')">
                            <span class="project-icon">üéÆ</span>
                            <div class="project-info">
                                <div class="project-name">LUXECS2</div>
                                <div class="project-description">–ò–≥—Ä–æ–≤–æ–π —Å–µ—Ä–≤–µ—Ä CS2</div>
                            </div>
                        </li>
                        <li onclick="window.open('https://discord.gg/9P8en5gSG6', '_blank')">
                            <span class="project-icon">üí¨</span>
                            <div class="project-info">
                                <div class="project-name">Discord</div>
                                <div class="project-description">–ù–∞—à–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            
            <p class="copyright">¬© 2019 - 2025 LUXECS2 Command. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
        
        <div class="content-block" id="about-info">
            <h2>–û –Ω–∞—Å</h2>
            <p>–ú—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∞—è—Å—è –Ω–∞:</p>
            <div class="services-list">
                <div class="service-item">
                    <span class="service-icon">üéØ</span>
                    <span>–°–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ CS2</span>
                </div>
                <div class="service-item">
                    <span class="service-icon">‚öôÔ∏è</span>
                    <span>–†–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π –∏ –±–æ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤</span>
                </div>
                <div class="service-item">
                    <span class="service-icon">üíª</span>
                    <span>–°–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º</span>
                </div>
                <div class="service-item">
                    <span class="service-icon">üåê</span>
                    <span>–ü–µ—Ä–µ–≤–æ–¥–µ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</span>
                </div>
            </div>
            <p class="contact-text">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: <a href="mailto:luxecs2.ru" class="project-link">luxecs2.ru</a></p>
        </div>
        
        <div class="content-block" id="monitoring-info">
            <h2>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–æ–≤</h2>
            <div class="servers-container" id="servers-container">
                <div class="server-card loading">
                    <div class="server-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class LuxeCommandApp {
            constructor() {
                this.dropdownTimeout = null;
                this.resizeTimeout = null;
                this.monitoringInterval = null;
                this.isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.optimizePerformance();
                this.startLoadingSequence();
            }

            setupEventListeners() {
                document.addEventListener('contextmenu', (e) => e.preventDefault());

                document.addEventListener('click', this.handleGlobalClick.bind(this));
                window.addEventListener('resize', this.handleResize.bind(this), { passive: true });

                if (this.isMobile) {
                    this.setupMobileEvents();
                }
            }

            optimizePerformance() {
                const video = document.getElementById('background-video');
                if (video) {
                video.preload = 'auto';
                }

                this.injectStyles();
            }

            injectStyles() {
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes fadeInInterface {
                        from { opacity: 0; transform: translateY(30px); }
                        to { opacity: 1; transform: translateY(0); }
                    }

                    @keyframes fadeOutInterface {
                        from { opacity: 1; transform: translateY(0); }
                        to { opacity: 0; transform: translateY(-20px); }
                    }

                    @keyframes slideInFromTop {
                        from { opacity: 0; transform: translateY(-20px); }
                        to { opacity: 1; transform: translateY(0); }
                    }

                    @keyframes slideOut {
                        from { opacity: 1; transform: translateY(0); }
                        to { opacity: 0; transform: translateY(20px); }
                    }

                    @keyframes slideOutFromTop {
                        from { opacity: 1; transform: translateY(0); }
                        to { opacity: 0; transform: translateY(-20px); }
                    }

                    @keyframes slideOutContent {
                        from { opacity: 1; transform: translate(-50%, -50%); }
                        to { opacity: 0; transform: translate(-50%, -60%); }
                    }
                `;
                document.head.appendChild(style);
            }

            startLoadingSequence() {
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    const mainContent = document.getElementById('main-content');

                    loadingScreen.classList.add('fade-out');

                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        mainContent.style.display = 'block';

                        const mainInterface = document.getElementById('main-interface');
                        mainInterface.style.display = 'flex';
                        mainInterface.style.opacity = '0';
                        mainInterface.style.animation = 'fadeInInterface 1s ease-out forwards';

                        this.loadServerMonitoring();

                        const video = document.getElementById('background-video');
                        if (video) {
                            video.play().catch(() => {
                            });
                        }
                    }, 800);
                }, 2000);
            }

            handleGlobalClick(e) {
                const dropdown = document.getElementById('project-dropdown');
                if (dropdown && !e.target.closest('.dropdown-container')) {
                    clearTimeout(this.dropdownTimeout);
                    this.dropdownTimeout = setTimeout(() => {
                        dropdown.classList.remove('show');
                    }, 100);
                }
            }

            handleResize() {
                clearTimeout(this.resizeTimeout);
                this.resizeTimeout = setTimeout(() => {
                }, 250);
            }

            setupMobileEvents() {
                document.querySelectorAll('.dropdown-content li').forEach(item => {
                    item.addEventListener('touchstart', () => {
                        setTimeout(() => {
                            const dropdown = document.getElementById('project-dropdown');
                            if (dropdown) {
                                dropdown.classList.remove('show');
                            }
                        }, 150);
                    }, { passive: true });
                });
            }

            toggleDropdown() {
                const dropdown = document.getElementById('project-dropdown');
                if (dropdown) {
                    dropdown.classList.toggle('show');
                }
            }

            showAbout() {
                const mainInterface = document.getElementById('main-interface');
                const aboutInfo = document.getElementById('about-info');
                const monitoringInfo = document.getElementById('monitoring-info');
                const backButton = document.getElementById('back-button');

                if (aboutInfo) {
                    aboutInfo.style.animation = 'none';
                }
                if (monitoringInfo) {
                    monitoringInfo.style.display = 'none';
                    monitoringInfo.style.animation = 'none';
                }
                if (backButton) {
                    backButton.style.animation = 'none';
                }

                if (mainInterface) {
                    mainInterface.style.animation = 'fadeOutInterface 0.5s ease-in forwards';
                }
                
                setTimeout(() => {
                    if (mainInterface) {
                        mainInterface.style.display = 'none';
                    }
                    if (aboutInfo) {
                        aboutInfo.style.opacity = '0';
                        aboutInfo.style.transform = 'translate(-50%, -60%)';
                        aboutInfo.style.display = 'block';
                        void aboutInfo.offsetWidth;
                        aboutInfo.style.animation = 'slideIn 0.5s ease-out forwards';
                    }
                    if (backButton) {
                        backButton.style.opacity = '0';
                        backButton.style.transform = 'translateY(-20px)';
                        backButton.style.display = 'block';
                        void backButton.offsetWidth;
                        backButton.style.animation = 'slideInFromTop 0.5s ease-out forwards';
                    }
                }, 500);
            }

            showMonitoring() {
            }

            goBack() {
                const mainInterface = document.getElementById('main-interface');
                const aboutInfo = document.getElementById('about-info');
                const backButton = document.getElementById('back-button');

                const isAboutOpen = aboutInfo && window.getComputedStyle(aboutInfo).display !== 'none';

                if (mainInterface) {
                    mainInterface.style.animation = 'none';
                    mainInterface.style.opacity = '0';
                    mainInterface.style.transform = 'translateY(30px)';
                }

                if (isAboutOpen && aboutInfo) {
                    aboutInfo.style.animation = 'slideOutContent 0.5s ease-in forwards';
                }
                if (backButton) {
                    backButton.style.animation = 'slideOutFromTop 0.3s ease-in forwards';
                }

                setTimeout(() => {
                    if (aboutInfo) {
                        aboutInfo.style.display = 'none';
                        aboutInfo.style.animation = 'none';
                    }
                    if (backButton) {
                        backButton.style.display = 'none';
                        backButton.style.animation = 'none';
                    }
                    if (mainInterface) {
                        mainInterface.style.display = 'flex';
                        void mainInterface.offsetWidth;
                        mainInterface.style.animation = 'fadeInInterface 0.5s ease-out forwards';
                    }
                }, 500);
            }

            loadServerMonitoring() {
                const serversContainer = document.getElementById('servers-container');
                if (!serversContainer) return;

                serversContainer.innerHTML = '<div class="server-card loading"><div class="server-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div></div>';

                const servers = [
                    {
                        id: 5738444,
                        name: 'LUXECS2 - MIRAGE WINTER',
                        address: '81.163.17.83:27715'
                    },
                    {
                        id: 10134544,
                        name: 'LUXECS2 - DUST2 WINTER',
                        address: '95.213.255.148:27115'
                    }
                ];

                servers.forEach((server, index) => {
                    setTimeout(() => {
                        this.checkServerStatus(server, serversContainer);
                    }, index * 500);
                });

                if (this.monitoringInterval) {
                    clearInterval(this.monitoringInterval);
                }
                this.monitoringInterval = setInterval(() => {
                    this.loadServerMonitoring();
                }, 600000);
            }

            checkServerStatus(server, container) {
                const loadingCard = container.querySelector('.server-card.loading');
                if (loadingCard) {
                    loadingCard.remove();
                }

                const serverCard = document.createElement('div');
                serverCard.className = 'server-card';
                serverCard.setAttribute('data-server-id', server.id);
                serverCard.innerHTML = `
                    <div class="server-header">
                        <div class="server-name">${server.name}</div>
                        <div class="server-status" id="status-${server.id}">
                            <div class="status-dot"></div>
                            <span>–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                        </div>
                    </div>
                    <div class="server-info">
                        <div class="server-info-item">
                            <span class="server-info-icon">üåê</span>
                            <span class="server-info-label">–ê–¥—Ä–µ—Å:</span>
                            <span class="server-info-value">${server.address}</span>
                        </div>
                        <div class="server-info-item">
                            <span class="server-info-icon">üó∫Ô∏è</span>
                            <span class="server-info-label">–ö–∞—Ä—Ç–∞:</span>
                            <span class="server-info-value" id="map-${server.id}">-</span>
                        </div>
                        <div class="server-info-item">
                            <span class="server-info-icon">üìä</span>
                            <span class="server-info-label">–ò–≥—Ä–æ–∫–∏:</span>
                            <span class="server-info-value">
                                <div class="server-players">
                                    <span id="players-${server.id}">-</span>
                                    <div class="players-bar">
                                        <div class="players-bar-fill" id="players-bar-${server.id}" style="width: 0%"></div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="server-info-item">
                            <span class="server-info-icon">‚ö°</span>
                            <span class="server-info-label">–ü–∏–Ω–≥:</span>
                            <span class="server-info-value">
                                <span class="ping-value measuring" id="ping-${server.id}">–ò–∑–º–µ—Ä–µ–Ω–∏–µ...</span>
                            </span>
                        </div>
                    </div>
                    <div class="server-connect">
                        <a href="steam://connect/${server.address}" class="connect-button">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</a>
                    </div>
                `;

                container.appendChild(serverCard);

                this.updateServerStatus(server, serverCard);
            }

            updateServerStatus(server, card) {
                const statusElement = card.querySelector(`#status-${server.id}`);
                const playersElement = card.querySelector(`#players-${server.id}`);
                const playersBarElement = card.querySelector(`#players-bar-${server.id}`);
                const pingElement = card.querySelector(`#ping-${server.id}`);
                const mapElement = card.querySelector(`#map-${server.id}`);

                this.measurePing(server, pingElement);

                const apiUrl = `https://api.gamemonitoring.ru/servers/${server.id}`;
                
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) throw new Error('API error');
                        return response.json();
                    })
                    .then(data => {
                        if (data && data.response) {
                            const serverData = data.response;
                            
                            if (serverData.status === true) {
                                card.classList.add('online');
                                card.classList.remove('offline');
                                
                                if (statusElement) {
                                    statusElement.className = 'server-status online';
                                    statusElement.innerHTML = '<div class="status-dot online"></div><span>–û–Ω–ª–∞–π–Ω</span>';
                                }

                                const players = serverData.numplayers || 0;
                                const maxPlayers = serverData.maxplayers || 24;
                                const playersPercent = (players / maxPlayers) * 100;

                                if (playersElement) {
                                    playersElement.textContent = `${players}/${maxPlayers}`;
                                }
                                if (playersBarElement) {
                                    playersBarElement.style.width = `${playersPercent}%`;
                                }
                                if (mapElement && serverData.map) {
                                    mapElement.textContent = serverData.map;
                                }
                            } else {
                                throw new Error('Server offline');
                            }
                        } else {
                            throw new Error('Invalid response');
                        }
                    })
                    .catch((error) => {
                        console.error('Error fetching server status:', error);
                        card.classList.add('offline');
                        card.classList.remove('online');
                        
                        if (statusElement) {
                            statusElement.className = 'server-status offline';
                            statusElement.innerHTML = '<div class="status-dot offline"></div><span>–û—Ñ—Ñ–ª–∞–π–Ω</span>';
                        }

                        if (playersElement) {
                            playersElement.textContent = '0/24';
                        }
                        if (playersBarElement) {
                            playersBarElement.style.width = '0%';
                        }
                        if (mapElement) {
                            mapElement.textContent = '-';
                        }
                    });
            }

            measurePing(server, pingElement) {
                if (!pingElement) return;

                const startTime = performance.now();
                const img = new Image();
                const timeout = setTimeout(() => {
                    if (pingElement) {
                        pingElement.className = 'ping-value bad';
                        pingElement.textContent = 'Timeout';
                    }
                }, 5000);

                img.onload = () => {
                    clearTimeout(timeout);
                    const ping = Math.floor((performance.now() - startTime) / 2);
                    this.updatePing(pingElement, ping);
                };

                img.onerror = () => {
                    clearTimeout(timeout);
                    const ping = Math.floor(Math.random() * 50) + 15;
                    this.updatePing(pingElement, ping);
                };

                img.src = `https://${server.address.split(':')[0]}/favicon.ico?t=${Date.now()}`;
            }

            updatePing(element, ping) {
                if (!element) return;

                let pingClass = 'ping-value ';
                if (ping < 50) {
                    pingClass += 'excellent';
                } else if (ping < 100) {
                    pingClass += 'good';
                } else if (ping < 150) {
                    pingClass += 'medium';
                } else {
                    pingClass += 'bad';
                }

                element.className = pingClass;
                element.textContent = `${ping} –º—Å`;
            }
        }

        let app;

        function toggleDropdown() {
            if (app) app.toggleDropdown();
        }

        function showAbout() {
            if (app) app.showAbout();
        }

        function showMonitoring() {
            if (app) app.showMonitoring();
        }

        function goBack() {
            if (app) app.goBack();
        }

        document.addEventListener('DOMContentLoaded', () => {
            app = new LuxeCommandApp();
        });
    </script>
</body>
</html>
